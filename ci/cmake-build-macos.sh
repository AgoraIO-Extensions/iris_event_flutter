#!/usr/bin/env bash

set -e
set -x

SCRIPTS_PATH=$(dirname "$0")
ROOT_PATH=$(pwd)
BUILD_TYPE="Release"

OUTPUT_ARTIFACTORY_NAME="Agora_Iris_Event_Flutter_for_macOS"
OUTPUT_ARTIFACTORY_PATH=$ROOT_PATH/build/$OUTPUT_ARTIFACTORY_NAME

mkdir -p $OUTPUT_ARTIFACTORY_PATH

bash $ROOT_PATH/cxx/build-macos.sh $ROOT_PATH/cxx $OUTPUT_ARTIFACTORY_PATH $BUILD_TYPE

ZIP_FILE_NAME="${OUTPUT_ARTIFACTORY_NAME}.zip"

pushd $ROOT_PATH/build
zip -r "$ZIP_FILE_NAME" $OUTPUT_ARTIFACTORY_NAME
popd